---
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";

import ProjectLink from "@components/ProjectLink.astro";

export interface Props {
  project: CollectionEntry<"projects">;
  includeImage: boolean;
}

const { project, includeImage } = Astro.props;
const { name, description, image, repoLink, demoLink, collaborator, primaryLanguage } = project.data;
---

<div class="flex flex-col overflow-hidden border border-blue bg-black">
  {includeImage && image && <Image src={image} alt={name} loading="eager" />}

  <div class="flex grow flex-col gap-2 p-4 text-sm">
    <h3 class="text-xl font-bold text-blue">{name}</h3>

    <p>{description}</p>

    {
      // prettier-ignore
      collaborator && (
        <p>
          Made in collaboration with
          <a class="text-blue underline" href={collaborator.github} target="_blank" rel="noopener noreferrer">{collaborator.name}</a>.
        </p>
      )
    }
    <div class="mt-auto flex flex-wrap justify-end gap-x-3">
      <span class="mr-auto flex items-center gap-1">
        <span class="language-indicator size-3 rounded-full"></span>
        <span>{primaryLanguage.name}</span>
      </span>
      {
        demoLink && (
          <ProjectLink icon="prime:globe" href={demoLink}>
            Demo
          </ProjectLink>
        )
      }
      {
        repoLink && (
          <ProjectLink icon="prime:github" href={repoLink}>
            Source
          </ProjectLink>
        )
      }
    </div>
  </div>
</div>

<style define:vars={{ backgroundColor: primaryLanguage.color }}>
  .language-indicator {
    background-color: var(--backgroundColor);
  }
</style>
