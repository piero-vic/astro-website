---
import dayjs from "dayjs";
import { getCollection } from "astro:content";

import BaseLayout from "../../layouts/BaseLayout.astro";
import PostList from "../../components/PostList.astro";

const title = "Blog";
const description = "Technical articles, code snippets, and writings on the things I'm learning.";

const posts = await getCollection("blog");

const posts21 = posts.filter(post => dayjs(post.data.pubDate).format("YYYY") == "2021");
const posts22 = posts.filter(post => dayjs(post.data.pubDate).format("YYYY") == "2022");
const posts24 = posts.filter(post => dayjs(post.data.pubDate).format("YYYY") == "2024");
---

<BaseLayout title={title} description={description}>
  <section class="mb-6">
    <h1 class="mb-3 text-4xl font-bold text-green md:mb-6 md:text-5xl">{title}</h1>
    <p class="mb-3">{description}</p>
  </section>

  <PostList heading="2024" posts={posts24} dateFormat="MMM D" />
  <PostList heading="2022" posts={posts22} dateFormat="MMM D" />
  <PostList heading="2021" posts={posts21} dateFormat="MMM D" />
</BaseLayout>
